(function(e,t,n){"use strict";function O(e,t){if(t&&t.onError){if(t.onError(e)===false){return}}this.name="JsRender Error";this.message=e||"JsRender error"}function M(e,t){var n;e=e||{};for(n in t){e[n]=t[n]}return e}function _(e,t,n){if(!rt.rTag||arguments.length){a=e?e.charAt(0):a;f=e?e.charAt(1):f;l=t?t.charAt(0):l;c=t?t.charAt(1):c;h=n||h;e="\\"+a+"(\\"+h+")?\\"+f;t="\\"+l+"\\"+c;o="(?:(?:(\\w+(?=[\\/\\s\\"+l+"]))|(?:(\\w+)?(:)|(>)|!--((?:[^-]|-(?!-))*)--|(\\*)))"+"\\s*((?:[^\\"+l+"]|\\"+l+"(?!\\"+c+"))*?)";rt.rTag=o+")";o=new RegExp(e+o+"(\\/)?|(?:\\/(\\w+)))"+t,"g");u=new RegExp("<.*>|([^\\\\]|^)[{}]|"+e+".*"+t)}return[a,f,l,c,h]}function D(e,t){if(!t){t=e;e=n}var r,i,s,o,u=this,a=!t||t==="root";if(e){o=u.type===t?u:n;if(!o){r=u.views;if(u._.useKey){for(i in r){if(o=r[i].get(e,t)){break}}}else for(i=0,s=r.length;!o&&i<s;i++){o=r[i].get(e,t)}}}else if(a){while(u.parent.parent){o=u=u.parent}}else while(u&&!o){o=u.type===t?u:n;u=u.parent}return o}function P(){var e=this.get("item");return e?e.index:n}function H(e,t){var r,i=this,s=t&&t[e]||(i.ctx||{})[e];s=s===n?i.getRsc("helpers",e):s;if(s){if(typeof s==="function"){r=function(){return s.apply(i,arguments)};M(r,s)}}return r||s}function B(e,t,r){var i,s,o,u=+r===r&&r,a=t.linkCtx;if(u){r=(u=t.tmpl.bnds[u-1])(t.data,t,A)}o=r.args[0];if(e||u){s=a&&a.tag||{_:{inline:!a},tagName:e+":",flow:true,_is:"tag"};s._.bnd=u;if(a){a.tag=s;r.ctx=G(r.ctx,a.view.ctx)}s.tagCtx=r;r.view=t;s.ctx=r.ctx||{};delete r.ctx;t._.tag=s;e=e!=="true"&&e;if(e&&((i=t.getRsc("converters",e))||V("Unknown converter: {{"+e+":"))){s.depends=i.depends;o=i.apply(s,r.args)}o=u&&t._.onRender?t._.onRender(o,t,u):o;t._.tag=n}return o}function j(e,t){var r,i=this,s=A[e];r=s&&s[t];while(r===n&&i){s=i.tmpl[e];r=s&&s[t];i=i.parent}return r}function F(e,t,r,i){var s,o,u,a,f,l,c,h,p,d,v,m,g,y,b="",w=+i===i&&i,E=t.linkCtx||0,S=t.ctx,x=r||t.tmpl,T=t._;if(e._is==="tag"){o=e;e=o.tagName}if(w){i=(m=x.bnds[w-1])(t.data,t,A)}c=i.length;o=o||E.tag;for(l=0;l<c;l++){p=i[l];v=p.tmpl;v=p.content=v&&x.tmpls[v-1];r=p.props.tmpl;if(!l&&(!r||!o)){g=t.getRsc("tags",e)||V("Unknown tag: {{"+e+"}}")}r=r||(o?o:g).template||v;r=""+r===r?t.getRsc("templates",r)||Z(r):r;M(p,{tmpl:r,render:X,index:l,view:t,ctx:G(p.ctx,S)});if(!o){if(g._ctr){o=new g._ctr;y=!!o.init;o.attr=o.attr||g.attr||n}else{o={render:g.render}}o._={inline:!E};if(E){E.attr=o.attr=E.attr||o.attr;E.tag=o;o.linkCtx=E}if(o._.bnd=m||E){o._.arrVws={}}o.tagName=e;o.parent=f=S&&S.tag;o._is="tag";o._def=g}T.tag=o;p.tag=o;o.tagCtxs=i;if(!o.flow){d=p.ctx=p.ctx||{};u=o.parents=d.parentTags=S&&G(d.parentTags,S.parentTags)||{};if(f){u[f.tagName]=f}d.tag=o}}o.rendering={};for(l=0;l<c;l++){p=o.tagCtx=i[l];o.ctx=p.ctx;if(!l&&y){o.init(p,E,o.ctx);y=n}if(s=o.render){h=s.apply(o,p.args)}b+=h!==n?h:p.tmpl?p.render():""}delete o.rendering;o.tagCtx=o.tagCtxs[0];o.ctx=o.tagCtx.ctx;if(o._.inline&&(a=o.attr)&&a!=="html"){b=a==="text"?et.html(b):""}return w&&t._.onRender?t._.onRender(b,t,w):b}function I(e,t,r,i,s,o,u,a){var f,l,c,h=t==="array",p={key:0,useKey:h?0:1,id:""+T++,onRender:a,bnds:{}},d={data:i,tmpl:s,content:u,views:h?[]:{},parent:r,ctx:e,type:t,get:D,getIndex:P,getRsc:j,hlp:H,_:p,_is:"view"};if(r){f=r.views;l=r._;if(l.useKey){f[p.key="_"+l.useKey++]=d;c=l.tag;p.bnd=h&&(!c||!!c._.bnd&&c)}else{f.splice(p.key=d.index=o!==n?o:f.length,0,d)}d.ctx=e||r.ctx}return d}function q(e){var t,n,r,i,s;for(t in L){i=L[t];if((s=i.compile)&&(n=e[t+"s"])){for(r in n){n[r]=s(r,n[r],e,t,i)}}}}function R(e,t,n){var r,i;if(typeof t==="function"){t={depends:t.depends,render:t}}else{if(i=t.template){t.template=""+i===i?Z[i]||Z(i):i}if(t.init!==false){r=t._ctr=function(e){};(r.prototype=t).constructor=r}}if(n){t._parentTmpl=n}return t}function U(r,i,s,o,a,f){function l(n){if(""+n===n||n.nodeType>0){try{h=n.nodeType>0?n:!u.test(n)&&t&&t(e.document).find(n)[0]}catch(i){}if(h){n=h.getAttribute(C);r=r||n;n=Z[n];if(!n){r=r||"_"+x++;h.setAttribute(C,r);n=Z[r]=U(r,h.innerHTML,s,o,a,f)}}return n}}var c,h;i=i||"";c=l(i);f=f||(i.markup?i:{});f.tmplName=r;if(s){f._parentTmpl=s}if(!c&&i.markup&&(c=l(i.markup))){if(c.fn&&(c.debug!==i.debug||c.allowCode!==i.allowCode)){c=c.markup}}if(c!==n){if(r&&!s){k[r]=function(){return i.render.apply(i,arguments)}}if(c.fn||i.fn){if(c.fn){if(r&&r!==c.tmplName){i=G(f,c)}else{i=c}}}else{i=z(c,f);J(c,i)}q(f);return i}}function z(e,t){var n,r=it.wrapMap||{},s=M({markup:e,tmpls:[],links:{},tags:{},bnds:[],_is:"template",render:X},t);if(!t.htmlTag){n=w.exec(e);s.htmlTag=n?n[1].toLowerCase():""}n=r[s.htmlTag];if(n&&n!==r.div){s.markup=i.trim(s.markup);s._elCnt=true}return s}function W(e,t){function r(s,o,u){var a,f,l,c;if(s&&""+s!==s&&!s.nodeType&&!s.markup){for(l in s){r(l,s[l],o)}return A}if(o===n){o=s;s=n}if(s&&""+s!==s){u=o;o=s;s=n}c=u?u[i]=u[i]||{}:r;f=t.compile;if(a=rt.onBeforeStoreItem){f=a(c,s,o,f)||f}if(!s){o=f(n,o)}else if(o===null){delete c[s]}else{c[s]=f?o=f(s,o,u,e,t):o}if(f&&o){o._is=e}if(a=rt.onStoreItem){a(c,s,o,f)}return o}var i=e+"s";A[i]=r;L[e]=t}function X(e,t,r,s,o,u){var a,f,l,c,h,p,d,v,m,g,y,b,w,E=this,S=!E.attr||E.attr==="html",x="";if(s===true){d=true;s=0}if(E.tag){v=E;E=E.tag;g=E._;b=E.tagName;w=v.tmpl;t=G(t,E.ctx);m=v.content;if(v.props.link===false){t=t||{};t.link=false}r=r||v.view;e=e===n?r:e}else{w=E.jquery&&(E[0]||V('Unknown template: "'+E.selector+'"'))||E}if(w){if(!r&&e&&e._is==="view"){r=e}if(r){m=m||r.content;u=u||r._.onRender;if(e===r){e=r.data;o=true}t=G(t,r.ctx)}if(!r||r.data===n){(t=t||{}).root=e}if(!w.fn){w=Z[w]||Z(w)}if(w){u=(t&&t.link)!==false&&S&&u;y=u;if(u===true){y=n;u=r._.onRender}if(i.isArray(e)&&!o){c=d?r:s!==n&&r||I(t,"array",r,e,w,s,m,u);for(a=0,f=e.length;a<f;a++){l=e[a];h=I(t,"item",c,l,w,(s||0)+a,m,u);p=w.fn(l,h,A);x+=c._.onRender?c._.onRender(p,h):p}}else{c=d?r:I(t,b||"data",r,e,w,s,m,u);if(g&&!E.flow){c.tag=E}x+=w.fn(e,c,A)}return y?y(x,c):x}}return""}function V(e){throw new A.sub.Error(e)}function $(e){V("Syntax error\n"+e)}function J(e,t,n,r){function i(t){t-=c;if(t){p.push(e.substr(c,t).replace(v,"\\n"))}}function s(t){t&&$('Unmatched or missing tag: "{{/'+t+'}}" in template:\n'+e)}function u(o,u,l,g,w,E,S,x,T,N,C,k){if(E){w=":";g="html"}N=N||n;var L,A,O=u&&[],M="",_="",D="",P=!N&&!w&&!S;l=l||w;i(k);c=k+o.length;if(x){if(f){p.push(["*","\n"+T.replace(m,"$1")+"\n"])}}else if(l){if(l==="else"){if(b.test(T)){$('for "{{else if expr}}" use "{{else expr}}"')}O=d[6];d[7]=e.substring(d[7],k);d=h.pop();p=d[3];P=true}if(T){T=T.replace(v," ");M=Q(T,O,t).replace(y,function(e,t,n){if(t){D+=n+","}else{_+=n+","}return""})}_=_.slice(0,-1);M=M.slice(0,-1);L=_&&_.indexOf("noerror:true")+1&&_||"";a=[l,g||!!r||"",M,P&&[],'params:"'+T+'",props:{'+_+"}"+(D?",ctx:{"+D.slice(0,-1)+"}":""),L,O||0];p.push(a);if(P){h.push(d);d=a;d[7]=c}}else if(C){A=d[0];s(C!==A&&A!=="else"&&C);d[7]=e.substring(d[7],k);d=h.pop()}s(!d&&C);p=d[3]}var a,f=t&&t.allowCode,l=[],c=0,h=[],p=l,d=[,,,l];e=e.replace(g,"\\$&");s(h[0]&&h[0][3].pop()[0]);e.replace(o,u);i(e.length);if(c=l[l.length-1]){s(""+c!==c&&+c[7]===c[7]&&c[0])}return K(l,n?e:t,n)}function K(e,n,r){var i,s,o,u,a,f,l,c,h,p,d,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O=0,M="",_="",D={},P=e.length;if(""+n===n){b=r?'data-link="'+n.replace(v," ").slice(1,-1)+'"':n;n=0}else{b=n.tmplName||"unnamed";if(n.allowCode){D.allowCode=true}if(n.debug){D.debug=true}m=n.bnds;y=n.tmpls}for(i=0;i<P;i++){s=e[i];if(""+s===s){M+='\nret+="'+s+'";'}else{o=s[0];if(o==="*"){M+=""+s[1]}else{u=s[1];a=s[2];S=s[3];f=s[4];_=s[5];x=s[7];if(!(C=o==="else")){O=0;if(m&&(g=s[6])){O=m.push(g)}}if(k=o===":"){if(u){o=u==="html"?">":u+o}if(_){L="prm"+i;_="try{var "+L+"=["+a+"][0];}catch(e){"+L+'="";}\n';a=L}}else{if(S){w=z(x,D);w.tmplName=b+"/"+o;K(S,w);y.push(w)}if(!C){E=o;N=M;M=""}T=e[i+1];T=T&&T[0]==="else"}f+=",args:["+a+"]}";if(k&&g||u&&o!==">"){A=new Function("data,view,j,u"," // "+b+" "+O+" "+o+"\n"+_+"return {"+f+";");A.paths=g;A._ctxs=o;if(r){return A}d=1}M+=k?"\n"+(g?"":_)+(r?"return ":"ret+=")+(d?(d=0,p=true,'c("'+u+'",view,'+(g?(m[O-1]=A,O):"{"+f)+");"):o===">"?(c=true,"h("+a+");"):(h=true,"(v="+a+")!="+(r?"=":"")+'u?v:"";')):(l=true,"{tmpl:"+(S?y.length:"0")+","+f+",");if(E&&!T){M="["+M.slice(0,-1)+"]";if(r||g){M=new Function("data,view,j,u"," // "+b+" "+O+" "+E+"\nreturn "+M+";");if(g){(m[O-1]=M).paths=g}M._ctxs=o;if(r){return M}}M=N+'\nret+=t("'+E+'",view,this,'+(O||M)+");";g=0;E=0}}}}M="// "+b+"\nvar j=j||"+(t?"jQuery.":"js")+"views"+(h?",v":"")+(l?",t=j._tag":"")+(p?",c=j._cnvt":"")+(c?",h=j.converters.html":"")+(r?";\n":',ret="";\n')+(it.tryCatch?"try{\n":"")+(D.debug?"debugger;":"")+M+(r?"\n":"\nreturn ret;\n")+(it.tryCatch?"\n}catch(e){return j._err(e);}":"");try{M=new Function("data,view,j,u",M)}catch(H){$("Compiled template code:\n\n"+M,H)}if(n){n.fn=M}return M}function Q(e,t,n){function r(r,d,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B){function F(e,n,r,u,a,f,l){if(n){if(t){if(i==="linkTo"){s=t.to=t.to||[];s.push(E)}if(!i||o){t.push(E)}}if(n!=="."){var c=(r?'view.hlp("'+r+'")':u?"view":"data")+(l?(a?"."+a:r?"":u?"":"."+n)+(f||""):(l=r?"":u?a||"":n,""));c=c+(l?"."+l:"");return c.slice(0,9)==="view.data"?c.slice(5):c}}return e}var j;S=S||"";b=b||d||L;E=E||N;C=C||D||"";if(x){$(e)}else{if(t&&_&&!y&&!g){if(!i||o||s){j=v[m];if(B.length-2>H-j){j=B.slice(j,H+1);_=f+":"+j+l;_=u[_]=u[_]||J(a+_+c,n,true);if(!_.paths){Q(j,_.paths=[],n)}(s||t).push({_jsvOb:_})}}}return y?(y=!A,y?r:'"'):g?(g=!O,g?r:'"'):(b?(m++,v[m]=H++,b):"")+(P?m?"":i?(i=o=s=false,"\b"):",":T?(m&&$(e),i=E,o=w,"\b"+E+":"):E?E.split("^").join(".").replace(p,F)+(C?(h[++m]=true,E.charAt(0)!=="."&&(v[m]=H),C):S):S?S:M?(h[m--]=false,M)+(C?(h[++m]=true,C):""):k?(h[m]||$(e),","):d?"":(y=A,g=O,'"'))}}var i,s,o,u=n.links,h={},v={0:-1},m=0,g=false,y=false;return(e+" ").replace(d,r)}function G(e,t){return e&&e!==t?t?M(M({},t),e):e:t&&M({},t)}function Y(e){return N[e]||(N[e]="&#"+e.charCodeAt(0)+";")}if(t&&t.views||e.jsviews){return}var r="v1.0.0-beta",i,s,o,u,a="{",f="{",l="}",c="}",h="^",p=/^(?:null|true|false|\d[\d.]*|([\w$]+|\.|~([\w$]+)|#(view|([\w$]+))?)([\w$.^]*?)(?:[.[^]([\w$]+)\]?)?)$/g,d=/(\()(?=\s*\()|(?:([([])\s*)?(?:(\^?)([#~]?[\w$.^]+)?\s*((\+\+|--)|\+|-|&&|\|\||===|!==|==|!=|<=|>=|[<>%*!:?\/]|(=))\s*|([#~]?[\w$.^]+)([([])?)|(,\s*)|(\(?)\\?(?:(')|("))|(?:\s*(([)\]])(?=\s*\.|\s*\^)|[)\]])([([]?))|(\s+)/g,v=/[ \t]*(\r\n|\n|\r)/g,m=/\\(['"])/g,g=/['"\\]/g,y=/\x08(~)?([^\x08]+)\x08/g,b=/^if\s/,w=/<(\w+)[>\s]/,E=/[\x00`><"'&]/g,S=E,x=0,T=0,N={"&":"&","<":"<",">":">","\0":"&#0;","'":"&#39;",'"':"&#34;","`":"&#96;"},C="data-jsv-tmpl",k={},L={template:{compile:U},tag:{compile:R},helper:{},converter:{}},A={jsviews:r,render:k,settings:{delimiters:_,debugMode:true,tryCatch:true},sub:{View:I,Error:O,tmplFn:J,parse:Q,extend:M,error:V,syntaxError:$},_cnvt:B,_tag:F,_err:function(e){return it.debugMode?"Error: "+(e.message||e)+". ":""}};(O.prototype=new Error).constructor=O;P.depends=function(){return[this.get("item"),"index"]};for(s in L){W(s,L[s])}var Z=A.templates,et=A.converters,tt=A.helpers,nt=A.tags,rt=A.sub,it=A.settings;if(t){i=t;i.fn.render=X}else{i=e.jsviews={};i.isArray=Array&&Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"}}i.render=k;i.views=A;i.templates=Z=A.templates;nt({"else":function(){},"if":{render:function(e){var t=this,n=t.rendering.done||!e&&(arguments.length||!t.tagCtx.index)?"":(t.rendering.done=true,t.selected=t.tagCtx.index,t.tagCtx.render());return n},onUpdate:function(e,t,n){var r,i,s;for(r=0;(i=this.tagCtxs[r])&&i.args.length;r++){i=i.args[0];s=!i!==!n[r].args[0];if(!!i||s){return s}}return false},flow:true},"for":{render:function(e){var t=this,r=t.tagCtx,s=!arguments.length,o="",u=s||0;if(!t.rendering.done){if(s){o=n}else if(e!==n){o+=r.render(e);u+=i.isArray(e)?e.length:1}if(t.rendering.done=u){t.selected=r.index}}return o},onArrayChange:function(e,t){var n,r=this,i=t.change;if(this.tagCtxs[1]&&(i==="insert"&&e.target.length===t.items.length||i==="remove"&&!e.target.length||i==="refresh"&&!t.oldItems.length!==!e.target.length)){this.refresh()}else{for(n in r._.arrVws){n=r._.arrVws[n];if(n.data===e.target){n._.onArrayChange.apply(n,arguments)}}}e.done=true},flow:true},include:{flow:true},"*":{render:function(e){return e},flow:true}});et({html:function(e){return e!=n?String(e).replace(S,Y):""},attr:function(e){return e!=n?String(e).replace(E,Y):e===null?null:""},url:function(e){return e!=n?encodeURI(String(e)):e===null?null:""}});_()})(this,this.jQuery)